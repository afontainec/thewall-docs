<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Overview | Chinchay Docs</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.ab30e0ca.css" as="style"><link rel="preload" href="/assets/js/app.2773cf3e.js" as="script"><link rel="preload" href="/assets/js/2.3f720234.js" as="script"><link rel="preload" href="/assets/js/34.c865156d.js" as="script"><link rel="prefetch" href="/assets/js/10.1edc54dd.js"><link rel="prefetch" href="/assets/js/11.2f00b1d8.js"><link rel="prefetch" href="/assets/js/12.1f05b6b4.js"><link rel="prefetch" href="/assets/js/13.c98ba095.js"><link rel="prefetch" href="/assets/js/14.1b2b2c75.js"><link rel="prefetch" href="/assets/js/15.702d946e.js"><link rel="prefetch" href="/assets/js/16.a41c1694.js"><link rel="prefetch" href="/assets/js/17.335d4649.js"><link rel="prefetch" href="/assets/js/18.23ce0973.js"><link rel="prefetch" href="/assets/js/19.aa8171a6.js"><link rel="prefetch" href="/assets/js/20.fcee7802.js"><link rel="prefetch" href="/assets/js/21.84451ad4.js"><link rel="prefetch" href="/assets/js/22.ca5d3982.js"><link rel="prefetch" href="/assets/js/23.d5279137.js"><link rel="prefetch" href="/assets/js/24.41953457.js"><link rel="prefetch" href="/assets/js/25.6f8b54bd.js"><link rel="prefetch" href="/assets/js/26.9965863d.js"><link rel="prefetch" href="/assets/js/27.5c297913.js"><link rel="prefetch" href="/assets/js/28.cc8160a1.js"><link rel="prefetch" href="/assets/js/29.3a7bb5f9.js"><link rel="prefetch" href="/assets/js/3.6a2b7fa3.js"><link rel="prefetch" href="/assets/js/30.42d9cb16.js"><link rel="prefetch" href="/assets/js/31.071fae85.js"><link rel="prefetch" href="/assets/js/32.9325ffa2.js"><link rel="prefetch" href="/assets/js/33.4af5988e.js"><link rel="prefetch" href="/assets/js/35.d3ce8ef4.js"><link rel="prefetch" href="/assets/js/36.11f74532.js"><link rel="prefetch" href="/assets/js/4.1b09c2c5.js"><link rel="prefetch" href="/assets/js/5.5c4c1fbb.js"><link rel="prefetch" href="/assets/js/6.b0461825.js"><link rel="prefetch" href="/assets/js/7.3211b211.js"><link rel="prefetch" href="/assets/js/8.a7dcf5bf.js"><link rel="prefetch" href="/assets/js/9.0aa8bee1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ab30e0ca.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Chinchay Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/gettingstarted/" class="nav-link">
  Getting Started
</a></div><div class="nav-item"><a href="/docs/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/models/" class="nav-link router-link-active">
  The Model
</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">
  Middleware
</a></div><div class="nav-item"><a href="/errorhandler/" class="nav-link">
  Error Handler
</a></div><div class="nav-item"><a href="/collaborate/" class="nav-link">
  Collaborate!
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/gettingstarted/" class="nav-link">
  Getting Started
</a></div><div class="nav-item"><a href="/docs/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/models/" class="nav-link router-link-active">
  The Model
</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">
  Middleware
</a></div><div class="nav-item"><a href="/errorhandler/" class="nav-link">
  Error Handler
</a></div><div class="nav-item"><a href="/collaborate/" class="nav-link">
  Collaborate!
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/models/newsave.html" class="sidebar-link">New</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/newsave.html#new" class="sidebar-link">New</a></li><li class="sidebar-sub-header"><a href="/models/newsave.html#save" class="sidebar-link">Save</a></li><li class="sidebar-sub-header"><a href="/models/newsave.html#save-several-at-once" class="sidebar-link">Save several at once</a></li></ul></li><li><a href="/models/find.html" class="sidebar-link">Find</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/find.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/models/find.html#simple-queries" class="sidebar-link">Simple Queries</a></li><li class="sidebar-sub-header"><a href="/models/find.html#queries-for-masters" class="sidebar-link">Queries for Masters</a></li><li class="sidebar-sub-header"><a href="/models/find.html#queries-for-and-or" class="sidebar-link">Queries for and/or</a></li><li class="sidebar-sub-header"><a href="/models/find.html#columns" class="sidebar-link">columns</a></li><li class="sidebar-sub-header"><a href="/models/find.html#startdate-and-enddate" class="sidebar-link">startDate and endDate</a></li><li class="sidebar-sub-header"><a href="/models/find.html#distinct" class="sidebar-link">distinct</a></li><li class="sidebar-sub-header"><a href="/models/find.html#order-by-limit-and-offset" class="sidebar-link">Order by, limit and offset</a></li><li class="sidebar-sub-header"><a href="/models/find.html#rawselect-and-rawwhere" class="sidebar-link">rawSelect and RawWhere</a></li><li class="sidebar-sub-header"><a href="/models/find.html#group-by" class="sidebar-link">Group By</a></li><li class="sidebar-sub-header"><a href="/models/find.html#return-as-query" class="sidebar-link">Return as Query</a></li><li class="sidebar-sub-header"><a href="/models/find.html#findbyid" class="sidebar-link">FindById</a></li><li class="sidebar-sub-header"><a href="/models/find.html#all" class="sidebar-link">all</a></li><li class="sidebar-sub-header"><a href="/models/find.html#findidin" class="sidebar-link">findIdIn</a></li><li class="sidebar-sub-header"><a href="/models/find.html#findin" class="sidebar-link">findIn</a></li><li class="sidebar-sub-header"><a href="/models/find.html#arrayofids" class="sidebar-link">arrayOfIds</a></li></ul></li><li><a href="/models/count.html" class="sidebar-link">Count</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/count.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/models/count.html#count-search-examples" class="sidebar-link">Count: Search Examples</a></li><li class="sidebar-sub-header"><a href="/models/count.html#startdate-and-enddate" class="sidebar-link">startDate and endDate</a></li><li class="sidebar-sub-header"><a href="/models/count.html#rawwhere" class="sidebar-link">rawWhere</a></li><li class="sidebar-sub-header"><a href="/models/count.html#group-by" class="sidebar-link">Group By</a></li><li class="sidebar-sub-header"><a href="/models/count.html#countdistinct" class="sidebar-link">countDistinct</a></li><li class="sidebar-sub-header"><a href="/models/count.html#return-as-query" class="sidebar-link">Return as Query</a></li><li class="sidebar-sub-header"><a href="/models/count.html#countgroupby" class="sidebar-link">countGroupBy</a></li><li class="sidebar-sub-header"><a href="/models/count.html#countin" class="sidebar-link">countIn</a></li></ul></li><li><a href="/models/update.html" class="sidebar-link">Update</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/update.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/models/update.html#update" class="sidebar-link">update</a></li><li class="sidebar-sub-header"><a href="/models/update.html#updatebyid" class="sidebar-link">updateById</a></li><li class="sidebar-sub-header"><a href="/models/update.html#what-cannot-be-set" class="sidebar-link">what cannot be set</a></li></ul></li><li><a href="/models/delete.html" class="sidebar-link">Delete</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/delete.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/models/delete.html#delete" class="sidebar-link">delete</a></li><li class="sidebar-sub-header"><a href="/models/delete.html#deletebyid" class="sidebar-link">deleteById</a></li></ul></li><li><a href="/models/aggregation.html" class="sidebar-link">Sum, Min &amp; Max</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/aggregation.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#sum" class="sidebar-link">Sum</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#max" class="sidebar-link">Max</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#min" class="sidebar-link">Min</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#sum-search-examples" class="sidebar-link">sum: Search Examples</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#startdate-and-enddate" class="sidebar-link">startDate and endDate</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#rawwhere" class="sidebar-link">rawWhere</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#group-by" class="sidebar-link">Group By</a></li><li class="sidebar-sub-header"><a href="/models/aggregation.html#return-as-query" class="sidebar-link">Return as Query</a></li></ul></li><li><a href="/models/miscellaneous.html" aria-current="page" class="active sidebar-link">Miscellaneous</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/miscellaneous.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/models/miscellaneous.html#columnsnames" class="sidebar-link">columnsNames</a></li><li class="sidebar-sub-header"><a href="/models/miscellaneous.html#getfirstdate" class="sidebar-link">getFirstDate</a></li><li class="sidebar-sub-header"><a href="/models/miscellaneous.html#extractoptions-extractcolumns-extractsearch" class="sidebar-link">extractOptions, extractColumns, extractSearch</a></li></ul></li><li><a href="/models/customMethods.html" class="sidebar-link">Creating your own methods</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/models/customMethods.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/models/customMethods.html#creating-custom-methods" class="sidebar-link">Creating custom methods</a></li><li class="sidebar-sub-header"><a href="/models/customMethods.html#overwriting-existing-methods" class="sidebar-link">Overwriting existing methods</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>There are several more miscellaneous functions that can be used. So here we will look at them.</p> <h2 id="columnsnames"><a href="#columnsnames" class="header-anchor">#</a> columnsNames</h2> <p>What if you want to get all the column names? Maybe to check if a certain relation has a certain property?</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  Coffee<span class="token punctuation">.</span><span class="token function">columnsNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>will return an array with the name of all the columns:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token punctuation">[</span> <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token string">'created_at'</span><span class="token punctuation">,</span> <span class="token string">'updated_at'</span> <span class="token punctuation">]</span>
</code></pre></div><h2 id="getfirstdate"><a href="#getfirstdate" class="header-anchor">#</a> getFirstDate</h2> <p>This method will return the created_at of the first entry:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  Coffee<span class="token punctuation">.</span><span class="token function">getFirstDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>will return a Date Object:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token number">2019</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">13</span>T21<span class="token operator">:</span><span class="token number">18</span><span class="token operator">:</span><span class="token number">08.748</span>Z
</code></pre></div><p>This is very similar to the following query:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  Coffee<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'all'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> rawSelect<span class="token operator">:</span> <span class="token string">'min(created_at)'</span><span class="token punctuation">,</span> clearSelect<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>However this will return an array with the result, whereas the first one will return the date straight away.</p> <h2 id="extractoptions-extractcolumns-extractsearch"><a href="#extractoptions-extractcolumns-extractsearch" class="header-anchor">#</a> extractOptions, extractColumns, extractSearch</h2> <p>The following methods are used in the controller, when running the <code>new</code> command. As you might have seen in the <a href="/docs/clientside.html#find">api client querying documentation</a>, Chinchay provides a whole querying system. Where the parameters are passed by the <a href="https://en.wikipedia.org/wiki/Query_string#:~:text=On%20the%20World%20Wide%20Web,part%20of%20an%20HTML%20form." target="_blank" rel="noopener noreferrer">Query String<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="extractoptions"><a href="#extractoptions" class="header-anchor">#</a> extractOptions</h3> <p>So let's dive into <code>extractOptions</code>:</p> <p>it receives a javascript object representing the query string (auto-generated by express). from it will create a new javascript object with all the elements corresponding to the option parameter and remove them from the query string. Let's look at an example:</p> <p>Let's assume the following request:</p> <div class="language- extra-class"><pre class="language-text"><code> curl --request GET 'http://localhost:3000/api/coffee/find?orderBy=id&amp;limit=2&amp;price=100&amp;columns=name'
</code></pre></div><p>If we look at the find function of the controller:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">find</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractOptions</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> columns <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractColumns</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> search <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractSearch</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  coffee<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>search<span class="token punctuation">,</span> columns<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> json <span class="token operator">=</span> httpResponse<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'Busqueda encontrada exitosamente'</span><span class="token punctuation">,</span> <span class="token string">'data'</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> json<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      json<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>links <span class="token operator">=</span> <span class="token constant">HATEOAS</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> code <span class="token operator">=</span> errorHandler<span class="token punctuation">.</span><span class="token function">getHTTPCode</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> errorHandler<span class="token punctuation">.</span><span class="token function">getHTTPMessage</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> json <span class="token operator">=</span> httpResponse<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> error<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>req.query</code> object at the beginning will be:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token punctuation">{</span> orderBy<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token string">'100'</span><span class="token punctuation">,</span> columns<span class="token operator">:</span> <span class="token string">'name'</span> <span class="token punctuation">}</span>
</code></pre></div><p>after the line:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">const</span> options <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractOptions</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>All the options properties have been removed from <code>req.query</code>. In this example only the price and the columns are left:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token string">'100'</span><span class="token punctuation">,</span> columns<span class="token operator">:</span> <span class="token string">'name'</span> <span class="token punctuation">}</span>
</code></pre></div><p>Whereas options:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span> orderBy<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token string">'2'</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="securitymode"><a href="#securitymode" class="header-anchor">#</a> SecurityMode</h4> <p>The <code>extractOptions</code> has an insecure mode, where it can be configured to extract also the <code>rawSelect</code> and the <code>rawWhere</code>. By default this mode is disabled, to enable it:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  req<span class="token punctuation">.</span>query <span class="token operator">=</span> <span class="token punctuation">{</span> orderBy<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token string">'100'</span><span class="token punctuation">,</span> rawSelect<span class="token operator">:</span> <span class="token string">'name as n'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractOptions</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">,</span> <span class="token punctuation">{</span> securityMode<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Options will include the rawSelect:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span> orderBy<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> rawSelect<span class="token operator">:</span> <span class="token string">'name as n'</span> <span class="token punctuation">}</span>
</code></pre></div><p>On the other hand:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  req<span class="token punctuation">.</span>query <span class="token operator">=</span> <span class="token punctuation">{</span> orderBy<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token string">'100'</span><span class="token punctuation">,</span> rawSelect<span class="token operator">:</span> <span class="token string">'name as n'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractOptions</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Options:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span> orderBy<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token string">'2'</span> <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>This is very dangerous. Why? Because through <code>rawSelect</code> and <code>rawQuery</code> sql commands can be injected to do harm, even delete the database! It is save to use if you are 100% sure that no malicious user will ever have access to it.</p></div> <h3 id="extractcolumns"><a href="#extractcolumns" class="header-anchor">#</a> extractColumns</h3> <p>This will remove from the <code>req.query</code> the columns property. It will return an array of all the columns, in the case there are no columns defined, it will return <code>'all'</code>. So in the previous example, after the line:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">const</span> columns <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractColumns</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>the <code>req.query</code> line will be:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token string">'100'</span> <span class="token punctuation">}</span>
</code></pre></div><p>Whereas the <code>columns</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span> <span class="token string">'name'</span> <span class="token punctuation">]</span>
</code></pre></div><p>However, if we request was:</p> <div class="language- extra-class"><pre class="language-text"><code> curl --request GET 'http://localhost:3000/api/coffee/find?orderBy=id&amp;limit=2&amp;price=100'
</code></pre></div><p>the <code>columns</code> would have been:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token string">'all'</span>
</code></pre></div><h3 id="extractsearch"><a href="#extractsearch" class="header-anchor">#</a> extractSearch</h3> <p>It will return an object with the query in the correct format. It will parse all the arrays. If we request the following:</p> <div class="language- extra-class"><pre class="language-text"><code> curl --request GET &quot;http://localhostfee/find?orderBy=id&amp;limit=2&amp;price=[\&quot;&gt;\&quot;,100]&quot; --globoff
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">info</p> <p>The <code>--globoff</code> flag is to allow the brackets characters: []</p></div> <p>The <code>req.query</code> object at the beginning will be:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token punctuation">{</span> orderBy<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token string">'[&quot;&gt;&quot;,100]'</span> <span class="token punctuation">}</span>
</code></pre></div><p>Note how the price is a string representing an array and not an array as we would have wanted.</p> <p>the following line fix that:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">const</span> search <span class="token operator">=</span> Table<span class="token punctuation">.</span><span class="token function">extractSearch</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>thereore the  <code>search</code> will be:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/models/aggregation.html" class="prev">
        Sum, Min &amp; Max
      </a></span> <span class="next"><a href="/models/customMethods.html">
        Creating your own methods
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2773cf3e.js" defer></script><script src="/assets/js/2.3f720234.js" defer></script><script src="/assets/js/34.c865156d.js" defer></script>
  </body>
</html>
